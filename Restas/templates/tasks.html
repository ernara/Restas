<!DOCTYPE html>
<html>
<head>
    <title>Task List</title>
</head>
<body>
    <h1>Task List</h1>
    <ul>
        <ul>
            {% for task in tasks %}
                <li>
                    {{ task.title }}
                    <button class="delete-button" data-task-id="{{ task.id }}">Delete</button>
                </li>
            {% endfor %}
        </ul>
    </ul>
    <!-- Form to create a new task -->
<form id="createTaskForm">
    <input type="text" id="taskTitle" placeholder="Enter task title" />
    <button type="button" onclick="createTask()">Create Task</button>
</form>

<script>
    function createTask() {
        var titleInput = document.getElementById("taskTitle");
        var title = titleInput.value;

        if (title) {
            fetch('/tasks', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 'title': title }),
            })
            .then(response => response.json())
            .then(data => {
                // Clear the input and update the task list
                titleInput.value = "";
                var taskList = document.querySelector("ul");
                var newTaskItem = document.createElement("li");
                newTaskItem.textContent = data.title;
                taskList.appendChild(newTaskItem);
            })
            .catch(error => console.error('Error:', error));
        }
    }

    function deleteTask(taskId) {
    fetch(`/tasks/${taskId}`, {
        method: 'DELETE'
    })
    .then(response => {
        if (response.ok) {
            // Reload the page to update the task list
            location.reload();
        } else {
            console.error('Error deleting task');
        }
    })
    .catch(error => console.error('Error:', error));
}
</script>

</body>
</html>
